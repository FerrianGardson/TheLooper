<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>The Looper</title>
    <!-- Внутренние ссылки -->
    <link
      class="local style base"
      rel="stylesheet"
      href="./tables/base.css"
      type="text/css"
    />
    <link
      class="local style noblegarden"
      rel="stylesheet"
      href="./tables/noblegarden.css"
      type="text/css"
    />

    <link
      class="local style sixthtroop"
      rel="stylesheet"
      href="./tables/sixthtroop.css"
      type="text/css"
      disabled
    />
    <link
      class="local style cheesecutter"
      rel="stylesheet"
      href="./tables/cheesecutter.css"
      type="text/css"
      disabled
    />
    <link
      class="local style selection"
      rel="stylesheet"
      href="./tables/selection.css"
      type="text/css"
      disabled
    />
    <!-- Внешние ссылки -->
    <link
      class="external style base"
      rel="stylesheet"
      href="https://ferriangardson.github.io/TheLooper/tables/base.css"
      type="text/css"
      disabled
    />
    <link
      class="external style noblegarden"
      rel="stylesheet"
      href="https://ferriangardson.github.io/TheLooper/tables/noblegarden.css"
      type="text/css"
      disabled
    />

    <!--     <link
      class="external style sixthtroop"
      rel="stylesheet"
      href="https://ferriangardson.github.io/TheLooper/tables/sixthtroop.css"
      type="text/css"
      disabled
    />
    <link
      class="external style cheesecutter"
      rel="stylesheet"
      href="https://ferriangardson.github.io/TheLooper/tables/cheesecutter.css"
      type="text/css"
      disabled
    /> -->
    <!--     <link
      class="external style selection"
      rel="stylesheet"
      href="https://ferriangardson.github.io/TheLooper/tables/mobile.css"
      type="text/css"
      disabled
    /> -->
  </head>

  <body style="margin: 0; height: 100vh; overflow: hidden">
    <div class="nav" style="display: none">
      <div class="buttons">
        <div class="hide group important">
          <form
            class="tumbler input tooltip show"
            tooltip="Открыть WoWChatLog.txt из папки Logs. Также позволяет открывать уже экспортированные отсюда HTML-файлы."
          >
            <label for="file-input-txt">Импорт</label>
            <input type="file" id="file-input-txt" />
          </form>
          <div
            class="checkbox tooltip hide"
            tooltip="Если включен, то импортирует в том числе ваши отписи в групповом чате"
          >
            <input type="checkbox" id="keepGroupCheckbox" checked="" /><label
              for="keepGroupCheckbox"
              >Группа</label
            >
          </div>
          <div
            class="checkbox tooltip hide"
            tooltip="Если включен, то импортирует в том числе ваши отписи в рейд-чате"
          >
            <input type="checkbox" id="keepRaidCheckbox" /><label
              for="keepRaidCheckbox"
              >Рейд</label
            >
          </div>
          <div
            class="checkbox tooltip hide"
            tooltip="Если включен, то импортирует в том числе объявления в рейд"
          >
            <input
              type="checkbox"
              id="keepRaidWarningCheckbox"
              checked=""
            /><label for="keepRaidWarningCheckbox">Объявления</label>
          </div>
        </div>

        <div class="hide group important">
          <button
            class="replace no-hover tooltip show"
            tooltip="Настройки отображения для удобства чтения и редактирования."
          >
            Вид</button
          ><button
            onclick="chapterReverse()"
            class="tooltip hide"
            tooltip="Влияет на то, в какой хронологии расположены отыгрыши — с самого первого или самого последнего."
          >
            Сначала новое</button
          ><button
            onclick="toggleChapters()"
            class="tooltip hide"
            tooltip="Развернуть или свернуть все главы, чтобы целиком пройтись по тексту или только пробежаться по верхам в поисках нужного отыгрыша."
          >
            Развернуть</button
          ><button
            onclick="toggleSelectionCSS()"
            class="tooltip hide"
            tooltip="Позволяет наглядно видеть, какие элементы выделены, а какие нет, чтобы провести редактирование и чистку логов."
          >
            Подсветка</button
          ><button
            onclick="selectAll()"
            class="tooltip hide"
            tooltip="Выделяет или снимает выделение со всех строк. Можно отдельно кликать на строки и выделять или снимать выделение. Кнопка «Очистка» оставит только выделенные части."
          >
            Выделить всё
          </button>
        </div>

        <div id="filter" class="hide group">
          <input
            type="text"
            id="keywordsInput"
            placeholder="Введите ключевые слова через запятую"
            value="Офелия, -смешно хрюкают"
            class="show"
          />
          <button
            onclick="logFilter()"
            class="tooltip show"
            tooltip="Выделить только строки, содержащие ключевые слова через запятую. Например: «Фэрриан, Ананита»."
          >
            Фильтр
          </button>
          <button
            onclick="filterTrimEverything()"
            class="tooltip hide"
            tooltip="Обрезает края каждой главы так, чтобы она начиналась и заканчивалась выделенными строками."
          >
            Обрезка
          </button>
        </div>
        <div class="removing hide group">
          <button class="show replace no-hover">Удалить</button>
          <div class="hide wrap col">
            <button
              onclick="removeUnselectedLoglines()"
              class="tooltip hide"
              tooltip="Удаляет все строки, с которых было снято выделение. Чтобы выделить или снять выделение, щёлкните по строке левой кнопкой мыши."
            >
              Строки</button
            ><button
              onclick="removeCollapsed()"
              class="tooltip hide"
              tooltip="Удаляет все главы кроме развёрнутых."
            >
              Главы</button
            ><button
              onclick="removePlayers()"
              class="tooltip hide"
              tooltip="Удаляет списки игроков под каждой главой. Если вы хотите удалить кого-то конкретного — просто наведитесь на него мышью и нажмите Del на клавиатуре."
            >
              Игроков</button
            ><button
              onclick="debug()"
              class="tooltip hide"
              tooltip="Не нажимай, убьёт!"
            >
              Дебаг
            </button>
          </div>
        </div>
        <div class="css hide group">
          <button class="show replace no-hover">CSS</button>

          <div class="wrap hide">
            <!--             <div class="checkbox">
              <input
                type="checkbox"
                id="nobleGardenCheckbox"
                onchange="toggleStylesheet('NobleGarden')"
                checked
              />
              <label for="nobleGardenCheckbox">NobleGarden</label>
            </div> -->
            <div class="checkbox">
              <input
                type="checkbox"
                id="sixthTroopCheckbox"
                onchange="toggleStylesheet('sixthtroop')"
              />
              <label for="sixthTroopCheckbox">Sixth Troop</label>
            </div>
            <div class="checkbox">
              <input
                type="checkbox"
                id="cheeseCutterCheckbox"
                onchange="toggleStylesheet('cheesecutter')"
              />
              <label for="cheeseCutterCheckbox">Cheese Cutter</label>
            </div>
          </div>
        </div>

        <button
          onclick="exportHTML()"
          class="tooltip"
          tooltip="Сохраняет страницу в виде HTML-файла, который вы можете скинуть друзьям. Его можно открыть как напрямую из папки «Загрузки», так и повторно импортировать на сайте через кнопку «Импорт»."
        >
          Экспорт
        </button>
      </div>
      <!-- <script src="https://cdn.jsdelivr.net/npm/transliteration@2.0.0/dist/transliteration.min.js"></script> -->
    </div>
    <button
      class="isolated"
      style="
        width: 100vw;
        height: 100vh;
        color: white;
        background: #0e0e0e;
        font-size: 3rem;
        font-family: math;
      "
      onclick="toggleExternalLinks()"
    >
      Кликни, чтобы начать!
    </button>

    <div class="post">
      <div class="paper controls">
        <h3>Управление</h3>
        <p>
          <span class="key">ЛКМ</span> — выделить строку / снять выделение в
          режиме (Вид — Подсветка).
        </p>
        <p>
          <span class="key">DEL</span> — удалить строку, картинку или главу.
        </p>
        <p>
          <span class="key">←</span> — превратить абзац под курсором в вырезку и
          обратно.
        </p>
        <p>
          <span class="key">→</span> — вставить под абзацем под курсором
          заготовку для картинки.
        </p>
        <p>
          <span class="key">↑</span> — переместить объект под курсором вверх.
        </p>
        <p>
          <span class="key">↓</span> — переместить объект под курсором вниз.
        </p>
        <p><span class="key">p</span> — вклеить реплику на обычную бумагу.</p>
        <p>
          <span class="key">m</span> — сделать вырезку с тайштампом, как при
          репликах со слова «Запись».
        </p>
        <p>
          <span class="key">+</span> — объединить чатбоксы, если это не до конца
          произошло автоматом.
        </p>
        <p><span class="key">/</span> — разделить главу на две разные.</p>
        <p class="">
          <span class="key">[</span> — начать выделение отрывка для
          использование с клавишами ниже.
        </p>

        <div class="subkeys">
          <p class="">
            <span class="key">]</span>&nbsp;— обернуть в бумажную вырезку.
          </p>
          <p class="">
            <span class="key">S</span>&nbsp;— спрятать отрывок под спойлер.
          </p>
          <p class="">
            <span class="key">DEL</span>&nbsp;— удалить выбранный участок.
          </p>
          <p class="">
            <span class="key">Enter</span>&nbsp;— объединить чатбоксы NPC.
          </p>
        </div>
      </div>
      <div>
        <div>
          <div>
            <div id="chatlog">
              <div class="chapter">
                <h2 class="date">
                  <span class="title">О мопсах и Часовых</span>
                  <span class="day">23 февраля,&nbsp;</span
                  ><span class="starttime">22:03</span
                  ><span class="durationtime">&nbsp;(0ч 15мин)</span>
                </h2>

                <div class="actors">
                  <ul class="players">
                    <li class="player rogue">Фэрриан Гардсон</li>
                  </ul>
                  <ul class="npc"></ul>
                </div>
                <div class="content">
                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say"
                      >Привет. Как насчёт развеяться и прогуляться до
                      Златоземья?<span class="emote"
                        >&nbsp;— взглянул на Офелию, поправляя плащ:
                        —&nbsp;</span
                      >Всё сидишь в каморке безвылазно. Даже от новой бойни с
                      гноллами удалось откреститься.</span
                    >
                  </p>

                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say">О чём думаешь?</span>
                  </p>

                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say"
                      >Маленькие собаки со сплюснутыми мордочками.</span
                    >
                  </p>

                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say">Так что, в Златоземье?</span>
                  </p>

                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say"
                      >Один калдорайский мудрец писал, что вся жизнь — это сон
                      бабочки. О диллеме, я ли — воин, грезящий себя во сне
                      бабочкой, или бабочка чутко спит и мнит себя во сне
                      воином.</span
                    >
                  </p>

                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say"
                      >Мне очень интересно читать об их тактиках. О том, как
                      они, не владея особой силой в ближнем бою, и не имея почти
                      никакой защиты, умудрялись сражаться что с опоенными
                      кровью Маннорота орками, что с целыми инферналами.</span
                    >
                  </p>

                  <p class="logline say selected">
                    <span class="player rogue">Фэрриан Гардсон</span
                    ><span class="say"
                      >В первую очередь — котлы. Несколько дюжин Часовых
                      занимают позиции в растительности вокруг какой-нибудь
                      поляны. И всадника на лунопарде, столкнувшаяся с
                      превосходящими силами врага, достаточно быстро, чтобы не
                      попасть под удары, но достаточно медленно, чтобы за ней
                      всё ещё пытались гнаться, заводит противника на эту
                      поляну. И тут со всех стороны обрушается ливень стрел. А
                      горлышко котла смыкается, когда путь назад врагу
                      преграждают древни.</span
                    >
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer"></div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!--     <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
      integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/transliteration@2.0.0/dist/transliteration.min.js"></script> -->
    <script>
      function toggleStylesheet(className) {
        const styleLinks = document.querySelectorAll(`.style.${className}`);
        styleLinks.forEach((link) => {
          if (link.disabled) {
            link.disabled = false;
          } else {
            link.disabled = true;
          }
        });
      }

      function toggleExternalLinks() {
        const localStyles = document.querySelectorAll(".local.style");
        const externalStyles = document.querySelectorAll(".external.style");

        localStyles.forEach((style) => {
          style.disabled = true;
        });

        externalStyles.forEach((style) => {
          style.disabled = false;
        });
      }
    </script>
    <script src="./tables/script.js" class="local style"></script>
    <!--     <script
      src="https://ferriangardson.github.io/TheLooper/tables/script.js"
      class="external style"
      disabled
    ></script> -->
  </body>
</html>
